# Análisis Y Visualización de Datos

Este capítulo se basa en preguntarse cosas sobre los datos e intentar sacar
conclusiones pero meramente usando gráficos.

## ¿Cuáles son las páginas más usadas para la búsqueda de empleo?

``` 
auxi <- table(unlist(Empleo$Job.finder))
auxi <- auxi[order(auxi,decreasing = TRUE)]

ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Buscadores", x = " ", y = " ")
```

```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- table(unlist(Empleo$Job.finder))
auxi <- auxi[order(auxi,decreasing = TRUE)]

ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Buscadores", x = " ", y = " ")

``` 


## ¿Cuáles son las competencias que más tienen las personas encuestadas?

``` 
auxi <- table(unlist(Empleo$Skills))
auxi <- auxi[order(auxi,decreasing = TRUE)]


ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Competencia", x = " ", y = " ")


``` 

```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- table(unlist(Empleo$Skills))
auxi <- auxi[order(auxi,decreasing = TRUE)]


ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Competencia", x = " ", y = " ")

``` 

## ¿Hay diferencias entre lo que estudian los hombres y las mujeres?

``` 
auxi <- Empleo %>%
  select(Gender,Studies.grouped.by.field) %>%
  filter(Gender == "Male") %>%
  group_by(Studies.grouped.by.field) %>%
  summarise(Hombres=n()) %>%
  arrange(Hombres) 


auxi[[2]][which(auxi == "Art")] <- auxi[[2]][which(auxi == "Art")] +1 
auxi[[2]][which(auxi == "Business")] <- auxi[[2]][which(auxi == "Business")] +1 
auxi <- auxi[-1,]


auxi <- inner_join(auxi, (Empleo %>%
                    select(Gender,Studies.grouped.by.field) %>%
                    filter(Gender == "Female") %>%
                    group_by(Studies.grouped.by.field) %>%
                    summarise(Mujeres=n()) %>%
                    arrange(Mujeres))
                          , by = "Studies.grouped.by.field")
for (x in c(1:nrow(auxi))) {
  auxi[nrow(auxi) + 1,] <- auxi %>% slice(x)
}

auxi <- auxi %>%
  mutate(Sexo = if_else(row_number()<=7,"Hombre", "Mujer"))

for (x in c(((nrow(auxi)/2)+1):nrow(auxi)  )   ) {
  print(x)
  auxi$Hombres[x] <- auxi$Mujeres[ (x - (nrow(auxi)/2) )    ]
}

auxi <- auxi %>%
  select(-3) %>%
  rename( "Contar" = Hombres)

ggplot(auxi, aes(x=unlist(Studies.grouped.by.field), y=Contar, fill = Sexo )) +
  geom_bar( stat='identity',position='dodge') +
  labs( fill = "Género", x = "Estudios por campo", y = "Número")
``` 

```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1

Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- Empleo %>%
  select(Gender,Studies.grouped.by.field) %>%
  filter(Gender == "Male") %>%
  group_by(Studies.grouped.by.field) %>%
  summarise(Hombres=n()) %>%
  arrange(Hombres) 


auxi[[2]][which(auxi == "Art")] <- auxi[[2]][which(auxi == "Art")] +1 
auxi[[2]][which(auxi == "Business")] <- auxi[[2]][which(auxi == "Business")] +1 
auxi <- auxi[-1,]


auxi <- inner_join(auxi, (Empleo %>%
                    select(Gender,Studies.grouped.by.field) %>%
                    filter(Gender == "Female") %>%
                    group_by(Studies.grouped.by.field) %>%
                    summarise(Mujeres=n()) %>%
                    arrange(Mujeres))
                          , by = "Studies.grouped.by.field")
for (x in c(1:nrow(auxi))) {
  auxi[nrow(auxi) + 1,] <- auxi %>% slice(x)
}

auxi <- auxi %>%
  mutate(Sexo = if_else(row_number()<=7,"Hombre", "Mujer"))

for (x in c(((nrow(auxi)/2)+1):nrow(auxi)  )   ) {
  print(x)
  auxi$Hombres[x] <- auxi$Mujeres[ (x - (nrow(auxi)/2) )    ]
}

auxi <- auxi %>%
  select(-3) %>%
  rename( "Contar" = Hombres)

ggplot(auxi, aes(x=unlist(Studies.grouped.by.field), y=Contar, fill = Sexo )) +
  geom_bar( stat='identity',position='dodge') +
  labs( fill = "Género", x = "Estudios por campo", y = "Número")

``` 

No hay mucha disparidad entre elecciones de campo de estudios por género,
hay que decir también que estos  datos son "de juguete" pueden estar más que
perfectamente sesgados o simplemente ser tan pequeños que no muestran nada.
Únicamente mencionar que hay muchas más mujeres que hombres con estudios 
relacionados con la informática

## Marital Status and interested in freelance

``` 
auxi <- Empleo %>% 
  select(Marital.status, Interested.in.freelance) %>%
  group_by(Marital.status, Interested.in.freelance) %>%
  summarise( numero = n()) 


auxi[[3]][which(auxi$Marital.status == "Married")] = 
  (auxi[[3]][which(auxi$Marital.status == "Married")])/sum(auxi[[3]][which(auxi$Marital.status == "Married")])


auxi[[3]][which(auxi$Marital.status == "Single")] = 
  (auxi[[3]][which(auxi$Marital.status == "Single")])/sum(auxi[[3]][which(auxi$Marital.status == "Single")])

auxi <- auxi[-4,]


ggplot(auxi, aes(x = unlist(Marital.status), y = numero, colour = Interested.in.freelance)) + 
   geom_point() + 
  labs( color = "Interesado en freelance", x = "Estado Civil", y = "Número")
```
```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- Empleo %>% 
  select(Marital.status, Interested.in.freelance) %>%
  group_by(Marital.status, Interested.in.freelance) %>%
  summarise( numero = n()) 


auxi[[3]][which(auxi$Marital.status == "Married")] = 
  (auxi[[3]][which(auxi$Marital.status == "Married")])/sum(auxi[[3]][which(auxi$Marital.status == "Married")])


auxi[[3]][which(auxi$Marital.status == "Single")] = 
  (auxi[[3]][which(auxi$Marital.status == "Single")])/sum(auxi[[3]][which(auxi$Marital.status == "Single")])

auxi <- auxi[-4,]


ggplot(auxi, aes(x = unlist(Marital.status), y = numero, colour = Interested.in.freelance)) + 
   geom_point() + 
  labs( color = "Interesado en freelance", x = "Estado Civil", y = "Número")

``` 


Tampoco hay diferencias muy reseñables aunque sí que es cierto que, ligeramente,
hay mayor porcentaje de personas casadas que están seguras de que no quieren
ser freelance y, por el contrario, hay más personas solteras que están pensando
si hacerlo.

## Age and freelance

``` 
auxi <- Empleo %>% 
  select(Age.group, Interested.in.freelance) %>%
  group_by(Age.group, Interested.in.freelance) %>%
  summarise( numero = n()) 

auxi[[3]][which(auxi$Age.group == "<25")] = 
  (auxi[[3]][which(auxi$Age.group == "<25")])/sum(auxi[[3]][which(auxi$Age.group == "<25")])

auxi[[3]][which(auxi$Age.group == "25-30")] = 
  (auxi[[3]][which(auxi$Age.group == "25-30")])/sum(auxi[[3]][which(auxi$Age.group == "25-30")])

auxi[[3]][which(auxi$Age.group == "31-40")] = 
  (auxi[[3]][which(auxi$Age.group == "31-40")])/sum(auxi[[3]][which(auxi$Age.group == "31-40")])


ggplot(auxi, aes(x = unlist(Age.group), y = numero, colour = Interested.in.freelance)) + 
  geom_point()
```

```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- Empleo %>% 
  select(Age.group, Interested.in.freelance) %>%
  group_by(Age.group, Interested.in.freelance) %>%
  summarise( numero = n()) 


auxi[[3]][which(auxi$Age.group == "<25")] = 
  (auxi[[3]][which(auxi$Age.group == "<25")])/sum(auxi[[3]][which(auxi$Age.group == "<25")])


auxi[[3]][which(auxi$Age.group == "25-30")] = 
  (auxi[[3]][which(auxi$Age.group == "25-30")])/sum(auxi[[3]][which(auxi$Age.group == "25-30")])

auxi[[3]][which(auxi$Age.group == "31-40")] = 
  (auxi[[3]][which(auxi$Age.group == "31-40")])/sum(auxi[[3]][which(auxi$Age.group == "31-40")])



ggplot(auxi, aes(x = unlist(Age.group), y = numero, colour = Interested.in.freelance)) + 
  geom_point()

``` 

Aquí ya sí podemos notar cierta separación que coincide más o menos con los datos esperados. Los más jóvenes son los más proclives a ser freelances (diferencia entre "Yes" y "No" mayor)
Los de 25-30 años tienen tanto el mísmo interés en serlo como en no serlo y los de 31-40
sorprendentemente tienen el porcentaje más alto de personas que quieren ser freelancers con casi un 60%

## "Gente que trabaja está contenta con su trabajo"

Entre comillas por qué vamos a buscar cuánta gente está en un trabajo y no busca
otro.

``` 
auxi <- Empleo %>%
  select(Currently.employed,Applying.4.job) %>%
  group_by(Currently.employed,Applying.4.job) %>%
  summarise( numero = n()) 


auxi[[3]][which(auxi$Currently.employed == "No")] = 
  (auxi[[3]][which(auxi$Currently.employed == "No")])/sum(auxi[[3]][which(auxi$Currently.employed == "No")])

auxi[[3]][which(auxi$Currently.employed == "Yes")] = 
  (auxi[[3]][which(auxi$Currently.employed == "Yes")])/sum(auxi[[3]][which(auxi$Currently.employed == "Yes")])

ggplot(auxi, aes(x = unlist(Currently.employed), y = numero, fill = Applying.4.job)) + 
  geom_bar( stat='identity')  + 
  labs( fill = "Buscando Trabajo", x = "Trabajando", y = "Número")
``` 
```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- Empleo %>%
  select(Currently.employed,Applying.4.job) %>%
  group_by(Currently.employed,Applying.4.job) %>%
  summarise( numero = n()) 


auxi[[3]][which(auxi$Currently.employed == "No")] = 
  (auxi[[3]][which(auxi$Currently.employed == "No")])/sum(auxi[[3]][which(auxi$Currently.employed == "No")])

auxi[[3]][which(auxi$Currently.employed == "Yes")] = 
  (auxi[[3]][which(auxi$Currently.employed == "Yes")])/sum(auxi[[3]][which(auxi$Currently.employed == "Yes")])

ggplot(auxi, aes(x = unlist(Currently.employed), y = numero, fill = Applying.4.job)) + 
  geom_bar( stat='identity')  + 
  labs( fill = "Buscando Trabajo", x = "Trabajando", y = "Número")

``` 

Empezando por abajo (Yes,No,Casually) es normal que gente que no tenga trabajo busque
más que los que si tienen y viceversa con "No"
pero vemos que hay un alto porcentaje de personas que no tienen trabajo y casualmente tampoco buscan ¿Estarán estudiando?

``` 
auxi <- Empleo %>%
  select(Currently.employed,Applying.4.job, Still.Studying) %>%
  group_by(Currently.employed,Applying.4.job,Still.Studying) %>%
  summarise( numero = n()) 

auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")] = 
  (auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")])/sum(auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")])

auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")] = 
  (auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")])/sum(auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")])


auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")] = 
  (auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")])/sum(auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")])

auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")] = 
  (auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")])/sum(auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")])


ggplot(auxi, aes(x = unlist(Currently.employed), y = numero, fill = Applying.4.job)) +
  geom_bar( stat='identity')  +
  facet_grid(.~Still.Studying) +
  labs( fill = "Buscando Trabajo", x = "Trabajando", y = "Número")
``` 
```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- table(unlist(Empleo$Job.finder))
auxi <- auxi[order(auxi,decreasing = TRUE)]

ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Buscadores", x = " ", y = " ")

``` 


## ¿Cuáles son las competencias que más tienen las personas encuestadas?

``` 
auxi <- table(unlist(Empleo$Skills))
auxi <- auxi[order(auxi,decreasing = TRUE)]


ggplot(as.data.frame(auxi), aes(x="", y=Freq, fill=Var1)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + 
  labs(fill = "Competencia", x = " ", y = " ")


``` 

```{r, echo=FALSE,message = FALSE,warning = FALSE,error=FALSE,results='hide'}
library(readr)
library(dplyr)
library(magrittr)
library(ggplot2)
library(rmarkdown)
library(tidyr)
library(fcaR)
library(arules)
library(cluster)
library(factoextra)
library(dendextend)   


Empleo <- read.delim("Survey.csv", header = TRUE, sep = ",", quote = "\"",
           dec = ".", fill = TRUE, comment.char = "")

Empleo <- drop_na(Empleo)


rownames(Empleo) <- Empleo$Name

Empleo <- Empleo %>%
  select(-c(Timestamp,X,Name))


Empleo <- Empleo %>%
  select(-Where.are.you.from.)


Empleo$Do.you.believe.degree.is.a.must.for.job.[
  Empleo$Do.you.believe.degree.is.a.must.for.job. == ""
  ] <- "Maybe"




Empleo <- Empleo %>%
           rename("Still.Studying" = Are.you.still.studying.,
                  "Is.degree.must.4.job" = Do.you.believe.degree.is.a.must.for.job.,
                  "Career.break"         = Did.you.have.a.career.break.,
                  "Career.switch"        = Did.you.switch.your.career.,
                  "Career.shift"         = Reason.for.shift.in.career.,
                  "Applying.4.job"       = Are.you.actively.applying.for.job.,
                  "Skills"               = Skills.that.you.are.confident,
                  "Personal.projects"    = Have.you.carried.out.any.independent.works.or.projects.,
                  "Job.finder"           = Where.do.you.search.for.Job.,
                  "Recruiter.response.you" = Are.you.receiving.response.from.recruiter.after.applying.,
                  "Job.search.problems"    = What.are.the.problems.faced.while.job.search.,
                  "Interested.in.freelance" = Are.you.interested.in.Freelancing.,
                  "Interested.in"           = Interested.area.of.work,
                  "Studies.grouped.by.level"    = Educational.Qualification,
                  "Dream.company.type"          = Dream.company.type.
                 )


Empleo <- Empleo %>%
  mutate("Studies.grouped.by.field"    = Studies.grouped.by.level)


Empleo <- Empleo %>%
        select(1:5, 23,6:22) 





Empleo[Empleo == "1-2years"]<- "Fresher"
Empleo[Empleo == "Doing Intership"]<- "Fresher"


Empleo[Empleo == "3+ years"]<- "Junior"


Empleo$Work.experience[!(Empleo$Work.experience == "Fresher" | 
                           Empleo$Work.experience == "Junior") ] <- "Senior"



unique(unlist(Empleo$Job.search.problems))


for (x in c("No problems ","No problems",
            "Still not looking for jobs actively",
            "I haven't applied for any. ","Nothing ",
            " interviewer not handsome ", "Good oppurtunities")
    ) {
  Empleo$Job.search.problems <- gsub(x,"Nothing",
                                             Empleo$Job.search.problems)
}


for (x in c("Lack of experience","Fear of English"," network slow at home")) {
  Empleo$Job.search.problems <- gsub(x,"My thing",
                                             Empleo$Job.search.problems)
}


unique(unlist(Empleo$Dream.company.type))


for (x in c("Google","Multinationals ","multinational companies",
            "Apple","Amazon","MNC")) {
  Empleo$Dream.company.type <- gsub(x,"Multinational",
                                             Empleo$Dream.company.type)
}

for (x in c("Both","Both ","All types ")) {
  Empleo$Dream.company.type <- gsub(x,"Both",
                                            Empleo$Dream.company.type)
}

for (x in c("Product based","Interior design ")) {
  Empleo$Dream.company.type <- gsub(x,"Specific",
                                            Empleo$Dream.company.type)
}

unique(unlist(Empleo$Job.finder))

for (x in c("Other ")) {
  Empleo$Job.finder <- gsub(x,"Other",Empleo$Job.finder)
}


unique(unlist(Empleo$Studies.grouped.by.level))

for (x in c("BSC physics","Bsc Physics ","Bsc physics ")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Bachelor of Science in Physics",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("M.tech","Mtech","M. tech")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Technology",
                                 Empleo$Studies.grouped.by.level)
}


for (x in c("BVOC IN SOFTWARE DEVELOPMENT ","bvoc in software development",
            "Bvoc in software development","B.voc Software development ",
            "BVOC SOFTWARE DEVELOPMENT ","BVOC in software development ",
            "BVOC IT IN SOFTWARE DEVELOPMENT ","Bvoc IT")) {
  Empleo$Studies.grouped.by.level<- gsub(x,"Bachelor of Vocational Studies in Software Development",
                                 Empleo$Studies.grouped.by.level)
}

for (x in c("Msc","MSc")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Master of Science",Empleo$Studies.grouped.by.level)
}

for (x in c("Diploma ","diploma","Diploma")) {
  Empleo$Studies.grouped.by.level <- gsub(x,"Diploma",Empleo$Studies.grouped.by.level)
}

Empleo$Studies.grouped.by.level <- gsub("MA","Master of Art",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("ITI","Industrial training institute",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("M Eng","Master of Engineering", Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bds","Bachelor of Dental Surgery",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Pharm D","Doctor of Pharmacy",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE EEE","Bachelor of Electrical and Electronics Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BE","Bachelor of Engineering",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bsc","Bachelor of Science",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MBA","Master of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Btech","Bachelor of Technology",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BCA","Bachelor of Computer Applications",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MSW","Master of Social work",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("MCA","Master in Computer Application",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Bcom","Bachelor of Commerce",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("BBA","Bachelor of Business Administration",Empleo$Studies.grouped.by.level)
Empleo$Studies.grouped.by.level <- gsub("Msc.physics","Master of Science in Physics",Empleo$Studies.grouped.by.level)


unique(unlist(Empleo$Studies.grouped.by.field))

Empleo$Studies.grouped.by.field[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Other"

Empleo$Studies.grouped.by.field[grep("Computer", Empleo$Studies.grouped.by.level)] <- "Computer"
Empleo$Studies.grouped.by.field[grep("Software", Empleo$Studies.grouped.by.level)] <- "Computer"

Empleo$Studies.grouped.by.field[grep("Science", Empleo$Studies.grouped.by.level)] <- "Science"
Empleo$Studies.grouped.by.field[grep("Technology", Empleo$Studies.grouped.by.level)] <- "Technology"
Empleo$Studies.grouped.by.field[grep("Engineering", Empleo$Studies.grouped.by.level)] <- "Engineering"

Empleo$Studies.grouped.by.field[grep("Dental", Empleo$Studies.grouped.by.level)] <- "Medical"
Empleo$Studies.grouped.by.field[grep("Pharmacy", Empleo$Studies.grouped.by.level)] <- "Medical"

Empleo$Studies.grouped.by.field[grep("Commerce", Empleo$Studies.grouped.by.level)] <- "Commerce"
Empleo$Studies.grouped.by.field[grep("Business", Empleo$Studies.grouped.by.level)] <- "Business"

Empleo$Studies.grouped.by.field[grep("Art", Empleo$Studies.grouped.by.level)] <- "Art"
Empleo$Studies.grouped.by.field[grep("Interior designing", Empleo$Studies.grouped.by.level)] <- "Art"

Empleo$Studies.grouped.by.field[grep("Social work", Empleo$Studies.grouped.by.level)] <- "Other"
Empleo$Studies.grouped.by.field[grep("Industrial training institute", Empleo$Studies.grouped.by.level)] <- "Other"


Empleo$Studies.grouped.by.field[Empleo$Studies.grouped.by.level==
                                  "Diplomain multimedia & bba (distance education third year)"] <- "Art;Business"

Empleo$Studies.grouped.by.level[grep("Bachelor", Empleo$Studies.grouped.by.level)] <- "Bachelor"
Empleo$Studies.grouped.by.level[grep("Master", Empleo$Studies.grouped.by.level)] <- "Master"
Empleo$Studies.grouped.by.level[grep("Diploma", Empleo$Studies.grouped.by.level)] <- "Diploma"
Empleo$Studies.grouped.by.level[grep("Doctor", Empleo$Studies.grouped.by.level)] <- "Doctor"

Empleo$Studies.grouped.by.level[!(Empleo$Studies.grouped.by.level=="Bachelor" |
                                  Empleo$Studies.grouped.by.level=="Master" |
                                  Empleo$Studies.grouped.by.level=="Diploma" |
                            Empleo$Studies.grouped.by.level=="Doctor")]<- "Other"




unique(unlist(Empleo$Interested.in))

Empleo$Interested.in[grep("Python", Empleo$Interested.in)] <- "Python"

for (x in c("Medical","Medicine","Nursing")) {
  Empleo$Interested.in <- gsub(x,"Medical",Empleo$Interested.in)
}

for (x in c("Accounts and Art Field","Admin","Aerospace engineering ",
            "Construction field","Embedded programming ","Engineering Design ",
            "Govt services","HR","Interior Designing","IT","Life science",
            "Love without work","Mechanical Design","Mechanical Engineering ",
            "QA- testing ","Interior designing 'autocad designing","Other ")) {
  Empleo$Interested.in <- gsub(x,"Other",Empleo$Interested.in)
}


unique(unlist(Empleo$Skills))

for (x in c("Wordpress","Css"," html","web designing ","html"," css","Rivet",
            " bootstrap","Angular","front-end development","Dotnet")) {
  Empleo$Skills <- gsub(x,"WebPages",Empleo$Skills)
}

for (x in c("cad","Autocad ","Design","CREO Design Software","autocad",
            "CAD/CAM","AutoDesign ","autoDesign")) {
  Empleo$Skills <- gsub(x,"Design",Empleo$Skills)
}

for (x in c(" MATLAB","Tableau ","Power BI","Powerbi")) {
  Empleo$Skills <- gsub(x,"Data Analysis",Empleo$Skills)
}


for (x in c("Nursing","Driving "," editing "," electronics","Digital marketing",
            "Tally prime ")) {
  Empleo$Skills <- gsub(x,"Other",Empleo$Skills)
}

for (x in c("Aspen","HTRI")) {
  Empleo$Skills <- gsub(x,"Simulator",Empleo$Skills)
}

for (x in c("Excel","Sql","Database")) {
  Empleo$Skills <- gsub(x,"Database",Empleo$Skills)
}

for (x in c("Python","C","c++"," embedded systems"," embedded c")) {
  Empleo$Skills <- gsub(x,"Programming Languages",Empleo$Skills,fixed=TRUE)
}



fc_Empleo <- FormalContext$new(Empleo)

for (x in names(Empleo)) {fc_Empleo$scale(x,type = "nominal")}

Emple01 <- as.data.frame(t(as.matrix(fc_Empleo$I)))





names(Emple01)[grep(",",names(Emple01))]

Emple01$`Studies.grouped.by.field = Art`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1
Emple01$`Studies.grouped.by.field = Business`[which(Emple01$`Studies.grouped.by.field = Art;Business` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database` == 1)] <- 1

Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01$`Skills = Other` [which(Emple01$`Skills = Database;Database;Other;Data Analysis` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Data Analysis` =`Skills = Database;Database;Other;Data Analysis`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other` == 1)] <- 1


Emple01$`Skills = Database` [which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Other,WebPages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database` == 1)  ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Database;Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Database;Other` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1
Emple01$`Skills = Data Analysis`[which(Emple01$`Skills = Database;Programming Languages;Design,Data Analysis` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Database;Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;Programming Languages;WebPages` == 1) ] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;Simulator,Simulator,Design` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Skills = Simulator` =`Skills = Database;Simulator,Simulator,Design`)


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Database;WebPages,Design` == 1)] <- 1


Emple01$`Skills = Database`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Database;WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1
Emple01$`Skills = Design`[which(Emple01$`Skills = Other;Design,Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Database`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Database;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = Other`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;Other;WebPages,WebPages,WebPages` == 1)] <- 1


Emple01$`Skills = Programming Languages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1
Emple01$`Skills = WebPages`[which(Emple01$`Skills = Programming Languages;WebPages,WebPages` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Business` == 1)] <- 1


Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Government`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Government;Private;Business` == 1)] <- 1


Emple01$`Job.preference = Business`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1
Emple01$`Job.preference = Private`[which(Emple01$`Job.preference = Private;Business` == 1)] <- 1


Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;` == 1)] <- 1

Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Fiverr` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Fiverr` =`Job.finder = Naukri;Linkedin;Fiverr`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1
Emple01$`Job.finder = Other`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Google` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;` == 1)] <- 1


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook ` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Social.Nets` =`Job.finder = Naukri;Linkedin;Indeed;Instagram, Facebook `)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Indeed`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist` == 1)] <- 1
Emple01 <- Emple01 %>%
  rename(`Job.finder = Hirist` =`Job.finder = Naukri;Linkedin;Indeed;Monster;Hirist`)


Emple01$`Job.finder = Naukri`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Linkedin`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1
Emple01$`Job.finder = Monster`[which(Emple01$`Job.finder = Naukri;Linkedin;Monster` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1
Emple01$`Job.search.problems = No response from recruiter`[which(Emple01$`Job.search.problems = My thing;No response from recruiter` == 1)] <- 1


Emple01$`Job.search.problems = My thing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1
Emple01$`Job.search.problems = Nothing`[which(Emple01$`Job.search.problems = My thing,My thing,Nothing` == 1)] <- 1


Emple01$`Dream.company.type = Multinational,Multinational,Multinational`[which(Emple01$`Dream.company.type = Multinational,Multinational,Multinational` == 1)] <- 1

Emple01 <- Emple01 %>% 
  select(-c(`Studies.grouped.by.field = Art;Business`,
            `Skills = Database;`,
            `Skills = Database;Database`,
            `Skills = Database;Other`,
            `Skills = Database;Other,WebPages`,
            `Skills = Database;Programming Languages`,
            `Skills = Database;Programming Languages;Database`,
            `Skills = Database;Programming Languages;Database;Data Analysis`,
            `Skills = Database;Programming Languages;Database;Other`,
            `Skills = Database;Programming Languages;Design,Data Analysis`,
            `Skills = Database;Programming Languages;Other`,
            `Skills = Database;Programming Languages;WebPages`,
            `Skills = Database;WebPages,Design`,
            `Skills = Database;WebPages,WebPages`,
            `Skills = Other;Design,Other`,
            `Skills = Other;Programming Languages,Programming Languages,Other,Programming Languages,Programming Languages,`,
            `Skills = Programming Languages;Database`,
            `Skills = Programming Languages;Database;Other`,
            `Skills = Programming Languages;Other`,
            `Skills = Programming Languages;Other;WebPages,WebPages,WebPages`,
            `Skills = Programming Languages;WebPages,WebPages`,
            `Job.preference = Government;Business`,
            `Job.preference = Government;Private`,
            `Job.preference = Government;Private;Business`,
            `Job.preference = Private;Business`,
            `Job.finder = Linkedin;`,
            `Job.finder = Linkedin;Indeed`,
            `Job.finder = Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin`,
            `Job.finder = Naukri;Linkedin;`,
            `Job.finder = Naukri;Linkedin;Indeed`,
            `Job.finder = Naukri;Linkedin;Indeed;`,
            `Job.finder = Naukri;Linkedin;Indeed;Google`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster`,
            `Job.finder = Naukri;Linkedin;Indeed;Monster;`,
            `Job.finder = Naukri;Linkedin;Monster`,
            `Job.search.problems = My thing;No response from recruiter`,
            `Job.search.problems = My thing,My thing,Nothing`,
            `Dream.company.type = Multinational,Multinational,Multinational`))


Emple01 <- Emple01 %>% mutate_all(as.logical)


Empleo <- Empleo %>%
  mutate(Job.search.problems = strsplit(Empleo$Job.search.problems, ";|,"),
         Job.finder          = strsplit(Empleo$Job.finder , ";|,"),
         Job.preference      = strsplit(Empleo$Job.preference , ";|,"),
         Skills              = strsplit(Empleo$Skills , ";|,"),
         Dream.company.type = strsplit(Empleo$Dream.company.type, ";|,"),
         Studies.grouped.by.field   = strsplit(Empleo$Studies.grouped.by.field , ";|,"),
         Interested.in              = strsplit(Empleo$Interested.in , '/'),
  )


auxi <- Empleo %>%
  select(Currently.employed,Applying.4.job, Still.Studying) %>%
  group_by(Currently.employed,Applying.4.job,Still.Studying) %>%
  summarise( numero = n()) 

auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")] = 
  (auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")])/sum(auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "No")])

auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")] = 
  (auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")])/sum(auxi[[4]][which(auxi$Currently.employed == "No" & auxi$Still.Studying == "Yes")])


auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")] = 
  (auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")])/sum(auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "No")])

auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")] = 
  (auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")])/sum(auxi[[4]][which(auxi$Currently.employed == "Yes" & auxi$Still.Studying == "Yes")])


ggplot(auxi, aes(x = unlist(Currently.employed), y = numero, fill = Applying.4.job)) +
  geom_bar( stat='identity')  +
  facet_grid(.~Still.Studying) +
  labs( fill = "Buscando Trabajo", x = "Trabajando", y = "Número")

``` 

Vemos que debe haber otro factor porque, por ejemplo, las personas que no
trabajan y no estudian, ¿Cómo es posible que estén buscando empleo de forma
"Casually"?
Luego en "No trabajando" y "Sí estudiando"  los datos son "normales"
"Sí trabajando" y "No estudiando" es lo que no hemos podido determinar pero 
podría ser que no estuvieran conformes con su trabajo
Por último, "Sí trabajando" y "Sí estudiando" se podría explicar debido a que
estén de prácticas empresariales, por ejemplo.
